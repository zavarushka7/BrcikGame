# Brick Game

## Описание проекта

Brick Game — это приложение, реализующее две классические игры: **Змейка** (Snake) и **Тетрис** (Tetris). Проект поддерживает как консольный интерфейс (с использованием библиотеки ncurses), так и графический интерфейс (на основе Qt). Код написан на языках C и C++ с использованием объектно-ориентированного подхода. 

### Основные особенности
- Реализация двух игр: Змейка и Тетрис.
- Два интерфейса: консольный (ncurses) и графический (Qt).
- Управление с помощью клавиш (стрелки, пробел, Enter, Esc, P).
- Поддержка паузы, перезапуска и выхода из игры.
- Сохранение и загрузка рекордов (файлы `.snake_high_score.txt` и `.tetris_high_score.txt`).
- Модульная архитектура с разделением на модель, контроллер и представление.
- Тестирование с использованием Google Test.
- Генерация отчётов о покрытии кода с помощью gcovr.
- Поддержка сборки динамической библиотеки для Тетриса.

## Требования

Для сборки и запуска проекта на Linux необходимо установить следующие зависимости:

### Для консольной версии
- **Компилятор C++**: g++ (с поддержкой стандарта C++17 или выше).
- **Библиотека ncurses**: `libncurses5-dev` или `libncurses6-dev` (для Ubuntu/Debian).
- **Google Test**: `libgtest-dev` (для запуска тестов).
- **gcovr**: для генерации отчётов о покрытии кода.
  ```bash
  sudo apt update
  sudo apt install g++ libncurses5-dev libgtest-dev gcovr
  ```

### Для графической версии
- **Qt**: версия 5 или 6 (`qt5-default` или `qt6-base-dev` для Ubuntu/Debian).
- **CMake**: версия 3.5 или выше (для сборки GUI).
  ```bash
  sudo apt install qt5-default cmake
  # или для Qt6:
  sudo apt install qt6-base-dev cmake
  ```

## Установка и сборка

### 1. Клонирование репозитория
Склонируйте репозиторий проекта на вашу локальную машину:
```bash
git clone <URL_репозитория>
cd brick_game
```

### 2. Сборка проекта
Проект использует Makefile для автоматизации сборки. Для сборки выполните:

```bash
make
```

При выполнении `make` появится меню с выбором версии игры:
- **1. Console version** — сборка консольной версии (требуется ncurses).
- **2. GUI version** — сборка графической версии (требуется Qt и CMake).

Выберите нужную опцию, используя стрелки и клавишу Enter.

#### Сборка консольной версии вручную
Если вы хотите собрать только консольную версию:
```bash
make console
```

#### Сборка графической версии
Для сборки GUI-версии:
```bash
make gui
```

### 3. Запуск игры
После успешной сборки запустите игру:
- Для консольной версии:
  ```bash
  ./build/brickgame_console
  ```
- Для GUI-версии:
  ```bash
  ./build/BrickGameApp
  ```

### 4. Тестирование
Для запуска тестов выполните:
```bash
make test
```
Тесты используют Google Test и проверяют функциональность модели Змейки.

### 5. Генерация отчёта о покрытии кода
Для создания отчёта о покрытии кода:
```bash
make gcov_report
```
Отчёт будет сгенерирован в формате HTML и автоматически открыт в браузере. Файл отчёта находится по пути `build/coverage.html`.

### 6. Очистка
Для удаления всех сгенерированных файлов:
```bash
make clean
```

### 7. Удаление установленного приложения
Для удаления всех файлов сборки:
```bash
make uninstall
```

## Управление игрой

### Общее управление
- **Стрелки влево/вправо** — выбор игры (Змейка или Тетрис) в меню выбора.
- **Enter** — запуск выбранной игры.
- **Esc** — выход из игры.
- **P** — пауза/возобновление игры.

### Управление в Змейке
- **Стрелки** — изменение направления движения змейки (вверх, вниз, влево, вправо).
- **Пробел** — ускоренное движение змейки (один шаг).
- **P** — пауза/возобновление.
- **Enter** — перезапуск после проигрыша или победы.

### Управление в Тетрисе
- **Стрелки** — перемещение/поворот фигур (вверх — поворот, влево/вправо — перемещение, вниз — ускорение падения).
- **Пробел** — моментальное падение фигуры (в GUI-версии).
- **P** — пауза/возобновление.
- **Enter** — перезапуск после проигрыша.

## Структура проекта

- **`brick_game/`**:
  - **`brick_game.h`** — общие определения и структуры данных для Змейки и Тетриса (перечисления состояний, действий, структуры `GameInfo_t`).
- **`brick_game/snake/`** — реализация игры Змейка:
  - `snakeModel.h/cpp` — модель игры, отвечает за логику (движение змейки, спавн яблок, обновление счета и уровня).
  - `snakeController.h/cpp` — контроллер, обрабатывает пользовательский ввод и переключает игры.
  - `consoleView.h/cpp` — консольное представление, отвечает за отображение игры в терминале с использованием ncurses.
- **`brick_game/tetris/`** — реализация Тетриса:
  - `backend.h/c` — логика Тетриса (создание и движение фигур, удаление линий, управление уровнями и скоростью).
  - `CMakeLists.txt` — файл для сборки библиотеки `libtetris.so`.
- **`gui/cli/`**:
  - `frontend.h/c` — функции для инициализации и отображения консольного интерфейса с использованием ncurses (цвета, поле, информация об игре).
- **`gui/desktop/`**:
  - `mainwindow.h/cpp` — реализация основного окна графического интерфейса на Qt, включая отображение игрового поля, следующей фигуры (для Тетриса), информации об игре и обработку ввода.
  - `CMakeLists.txt` — файл для сборки графической версии приложения.
- **`tests/`** — тесты для модели Змейки (используют Google Test).
- **`main.cpp`**:
  - Для консольной версии: точка входа, инициализирующая модель, контроллер и консольное представление.
  - Для GUI-версии: запуск приложения Qt с созданием окна `MainWindow`.
- **`Makefile`** — файл для сборки, тестирования, проверки форматирования и генерации отчётов.
